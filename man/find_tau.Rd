% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/find_tau.R
\name{find_tau}
\alias{find_tau}
\title{Calculate Significance Threshold for Peak Curvature in Function Curves}
\usage{
find_tau(function_curves, time_grid, percentile)
}
\arguments{
\item{function_curves}{A functional data object containing the curves to analyze.}

\item{time_grid}{A numeric vector representing the time points or grid on which the functions are evaluated.}

\item{percentile}{A numeric value between 0 and 100 specifying the percentile to use for threshold determination.}
}
\value{
A numeric value representing the threshold (tau) at the specified percentile of normalized curvature values.
}
\description{
This function identifies a threshold value (tau) above which the curvature of peaks
in function curves are considered significant. The process involves smoothing the
input curves, calculating derivatives to identify peaks, and then determining the
normalized curvature values at these peaks.
}
\details{
The function performs the following steps:
\enumerate{
\item Smooths the input function curves using lowess smoothing
\item Calculates first and second derivatives
\item Identifies peaks as points where the slope changes from positive to negative
\item Calculates normalized curvature values at these peaks
\item Returns the value at the specified percentile of all curvature values
}

Note that curvature values are negated and normalized by the maximum absolute value,
with negative values truncated to zero.
}
\examples{
\dontrun{
# Assuming functions_data is a functional data object with time_grid
tau <- find_tau(functions_data, time_grid, percentile = 95)
}

}
