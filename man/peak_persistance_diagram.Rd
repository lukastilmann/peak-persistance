% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pp_diagram.R
\name{peak_persistance_diagram}
\alias{peak_persistance_diagram}
\title{Create Peak Persistence Diagram for Aligned Functions}
\usage{
peak_persistance_diagram(
  curves,
  t_grid,
  parallel = FALSE,
  parallel_max_lambda = FALSE,
  lambda_search_start = 2,
  lambda_search_min_bound = 0.01,
  lambda_search_threshold = 0.001,
  max_lambda_search_steps = 20,
  curvature_percentile = NULL,
  basis_dim = 20,
  max_iter = 20,
  penalty = c("roughness", "geodesic"),
  n_lambda = 10,
  lambda_grid_spacing = "sqrt",
  sig_threshold = 0.03,
  pers_threshold = 0.28,
  pers_method = c("clustering", "threshold")
)
}
\arguments{
\item{curves}{An object containing functional data to be analyzed, compatible with the tfb function.}

\item{t_grid}{Numeric vector representing the time grid for the functional data.}

\item{parallel}{Logical indicating whether to use parallel processing.}

\item{lambda_search_start}{Numeric, starting value for searching maximum lambda (default: 2).}

\item{lambda_search_min_bound}{Numeric, minimum bound for lambda search (default: 0.01).}

\item{lambda_search_threshold}{Numeric, convergence threshold for lambda search (default: 1e-3).}

\item{max_lambda_search_steps}{Integer, maximum number of steps for lambda search (default: 20).}

\item{max_iter}{Integer, maximum number of iterations for align_functions (default: 20).}

\item{penalty}{Character, penalty used in function alignment.}

\item{n_lambda}{Integer, number of lambda values to evaluate (default: 10).}

\item{sig_threshold}{Numeric, threshold for peak significance (default: 0.03).}

\item{pers_threshold}{Numeric, threshold for peak persistence when using 'threshold' method (default: 0.28).}

\item{pers_method}{Character, method for determining persistent peaks: "clustering" or "threshold" (default: "clustering").}
}
\value{
A list containing:
\itemize{
\item bc: Persistence diagram in barchart form
\item surface: Peak persistence surface plot
\item significant_peaks: Vector of significant peaks at optimal lambda
\item persistent_peaks: Vector of persistent peaks across lambda values
\item significance_intervals: Intervals showing peak significance
\item lambdas: Vector of lambda values used
\item time_grid: Time grid used
\item mean_function: Mean function at optimal lambda
\item peak_locs: Peak locations at optimal lambda
\item valley_locs: Valley locations at optimal lambda
\item labels: Peak labels at optimal lambda
\item lambda_opt: Optimal lambda value
\item num_peaks: Number of persistent peaks
\item aligned_functions: Aligned functions at optimal lambda
\item warping_functions: Warping functions at optimal lambda
}
}
\description{
This function creates barchart and surface diagrams tracking peaks of aligned functions
for different lambda values. It identifies significant and persistent peaks across
multiple levels of alignment regularization.
}
\examples{
\dontrun{
# Assuming 'my_curves' contains functional data and 't_grid' is defined
result <- peak_persistance_diagram(my_curves, t_grid)
plot(result$bc)
plot(result$surface)
}

}
